# 🚨 安全事件响应指南

## 📋 敏感信息泄漏处理标准流程

### ⚠️ **重要原则：永远不要在任何地方明文提及敏感信息！**

### 🔧 **标准处理流程**：

#### 1. **发现阶段**
```bash
# ❌ 错误做法：直接搜索具体密钥
grep -r "sk-abc123..." .

# ✅ 正确做法：使用模式搜索
grep -r "sk-[a-zA-Z0-9]\{40\}" .
```

#### 2. **清理阶段**
```bash
# ❌ 错误做法：在脚本中包含原始值
sed -i 's/原始密钥/占位符/g' file

# ✅ 正确做法：使用变量或模式
PATTERN="sk-[a-zA-Z0-9]\{40\}"
sed -i "s/$PATTERN/[已移除API密钥]/g" file
```

#### 3. **提交阶段**
```bash
# ❌ 错误做法：在提交信息中提及敏感信息
git commit -m "修复密钥 sk-abc123... 泄漏"

# ✅ 正确做法：使用通用描述
git commit -m "🔐 安全修复：移除泄漏的API密钥和配置信息"
```

#### 4. **文档阶段**
```markdown
# ❌ 错误做法：
修复了以下泄漏：
- AppID: wx1234567890abcdef
- Secret: abc123def456...

# ✅ 正确做法：
修复了以下类型的泄漏：
- 微信小程序AppID (wx开头的16位字符)
- API密钥 (sk-开头的40位字符)
```

## 🛡️ **安全检查清单**

### 在每次操作前确认：
- [ ] 命令中不包含敏感信息明文
- [ ] 文件名不暴露敏感信息
- [ ] 提交信息使用通用描述
- [ ] 日志输出经过过滤
- [ ] 临时文件已清理

## 🔍 **敏感信息识别模式**

### 常见敏感信息类型：
```bash
# 微信相关
wx[a-z0-9]{16}              # AppID
[a-z0-9]{32}                # AppSecret

# API密钥
sk-[a-zA-Z0-9]{40,}         # OpenAI/DeepSeek格式
[A-Za-z0-9]{32,}            # 通用32位密钥

# 数据库密码
password.*=.*[^{].*[a-zA-Z0-9!@#$%^&*()_+-=]{8,}

# JWT密钥
[A-Za-z0-9+/]{32,}={0,2}    # Base64编码密钥
```

## 📞 **紧急响应流程**

### 如果发现已经泄漏：
1. **立即停止** - 停止当前操作
2. **评估范围** - 确定泄漏范围和影响
3. **清理历史** - 使用 git filter-branch 清理历史
4. **轮换密钥** - 立即重新生成所有相关密钥
5. **通知相关方** - 通知所有可能受影响的系统
6. **更新防护** - 加强监控和防护措施

## 🔄 **事后总结**

每次安全事件后：
- 分析根本原因
- 更新流程文档
- 加强团队培训
- 完善自动化检查

---

**记住：安全无小事，预防胜于治疗！** 🔐 