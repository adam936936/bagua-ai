# å¾®ä¿¡å°ç¨‹åºå¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—

## ğŸ“‹ é¡¹ç›®ç»“æ„æ¦‚è§ˆ

```
bagua-ai/
â”œâ”€â”€ frontend/                 # å‰ç«¯å¾®ä¿¡å°ç¨‹åºä»£ç 
â”‚   â”œâ”€â”€ src/                 # æºä»£ç 
â”‚   â”œâ”€â”€ pages/               # é¡µé¢æ–‡ä»¶
â”‚   â”œâ”€â”€ utils/               # å·¥å…·ç±»
â”‚   â”œâ”€â”€ api/                 # APIæ¥å£å°è£…
â”‚   â”œâ”€â”€ project.config.json  # å¾®ä¿¡å°ç¨‹åºé…ç½®
â”‚   â””â”€â”€ proxy-server.js      # ä»£ç†æœåŠ¡å™¨ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ backend/                 # åç«¯Spring Bootåº”ç”¨
â”‚   â”œâ”€â”€ src/                 # æºä»£ç 
â”‚   â”œâ”€â”€ Dockerfile           # Dockeræ„å»ºæ–‡ä»¶
â”‚   â””â”€â”€ pom.xml              # Mavené…ç½®
â”œâ”€â”€ nginx/                   # Nginxé…ç½®
â”œâ”€â”€ scripts/                 # å„ç§è„šæœ¬
â”œâ”€â”€ docker-compose.yml       # Dockerç¼–æ’æ–‡ä»¶
â”œâ”€â”€ start-wechat-dev.sh      # å¾®ä¿¡å°ç¨‹åºå¼€å‘ç¯å¢ƒå¯åŠ¨è„šæœ¬
â”œâ”€â”€ stop-wechat-dev.sh       # åœæ­¢è„šæœ¬
â””â”€â”€ test-wechat-api.sh       # APIæµ‹è¯•è„šæœ¬
```

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### 1. å¯åŠ¨å¼€å‘ç¯å¢ƒ

```bash
# å¯åŠ¨å®Œæ•´çš„å¾®ä¿¡å°ç¨‹åºå¼€å‘ç¯å¢ƒ
./start-wechat-dev.sh
```

### 2. æµ‹è¯•APIæ¥å£

```bash
# æµ‹è¯•æ‰€æœ‰APIæ¥å£
./test-wechat-api.sh
```

### 3. åœæ­¢ç¯å¢ƒ

```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
./stop-wechat-dev.sh
```

## ğŸ”§ ç«¯å£é…ç½®

**ç»Ÿä¸€ä½¿ç”¨8081ç«¯å£è¿›è¡Œå‰åç«¯é€šä¿¡ï¼š**

- **åç«¯API**: `http://localhost:8081/api`
- **å‰ç«¯ä»£ç†**: `http://localhost:8081` (å¯é€‰)
- **MySQL**: `localhost:3306`
- **Redis**: `localhost:6379`
- **Nginx**: `http://localhost:80`

## ğŸ“± å¾®ä¿¡å°ç¨‹åºé…ç½®

### 1. å¾®ä¿¡å¼€å‘è€…å·¥å…·è®¾ç½®

åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼š

1. **å¯¼å…¥é¡¹ç›®**: é€‰æ‹© `frontend` ç›®å½•
2. **AppID**: åœ¨ `project.config.json` ä¸­é…ç½®
3. **æœåŠ¡å™¨åŸŸå**: è®¾ç½®ä¸º `localhost:8081`
4. **ä¸æ ¡éªŒåˆæ³•åŸŸå**: å¼€å‘é˜¶æ®µå»ºè®®å¼€å¯

### 2. APIåŸºç¡€é…ç½®

å‰ç«¯è¯·æ±‚é…ç½®ï¼ˆ`frontend/utils/request.js`ï¼‰ï¼š

```javascript
const baseURL = 'http://localhost:8081/api';
```

## ğŸ”Œ å¯ç”¨çš„APIæ¥å£

### åŸºç¡€æ¥å£

- **å¥åº·æ£€æŸ¥**: `GET /api/actuator/health`
- **ç®€å•æµ‹è¯•**: `GET /api/simple/hello`
- **è¿åŠ¿æµ‹è¯•**: `GET /api/simple/fortune-test`

### æ ¸å¿ƒåŠŸèƒ½æ¥å£

- **ä»Šæ—¥è¿åŠ¿**: `GET /api/fortune/today-fortune`
- **å‘½ç†è®¡ç®—**: `POST /api/fortune/calculate`

### è¯·æ±‚ç¤ºä¾‹

```bash
# è·å–ä»Šæ—¥è¿åŠ¿
curl http://localhost:8081/api/fortune/today-fortune

# å‘½ç†è®¡ç®—
curl -X POST http://localhost:8081/api/fortune/calculate \
  -H "Content-Type: application/json" \
  -d '{
    "name": "å¼ ä¸‰",
    "birthDate": "1990-01-01",
    "birthTime": "08:00",
    "gender": "male"
  }'
```

## ğŸ³ DockeræœåŠ¡

### æœåŠ¡ç»„ä»¶

- **bagua-mysql**: MySQL 8.0 æ•°æ®åº“
- **bagua-redis**: Redis 7 ç¼“å­˜æœåŠ¡
- **bagua-backend**: Spring Boot åç«¯åº”ç”¨
- **bagua-nginx**: Nginx åå‘ä»£ç†

### å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend

# é‡å¯æœåŠ¡
docker-compose restart backend

# å®Œå…¨é‡å»º
docker-compose down && docker-compose up -d --build
```

## ğŸ› ï¸ å¼€å‘è°ƒè¯•

### 1. åç«¯è°ƒè¯•

```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
docker logs bagua-backend -f

# è¿›å…¥åç«¯å®¹å™¨
docker exec -it bagua-backend bash

# æ£€æŸ¥ç¯å¢ƒå˜é‡
docker exec bagua-backend env | grep -E "(REDIS|MYSQL)"
```

### 2. æ•°æ®åº“è°ƒè¯•

```bash
# è¿æ¥MySQL
docker exec -it bagua-mysql mysql -u fortune_user -p fortune_db

# è¿æ¥Redis
docker exec -it bagua-redis redis-cli -a redis123456
```

### 3. å‰ç«¯è°ƒè¯•

```bash
# å¯åŠ¨å‰ç«¯ä»£ç†æœåŠ¡å™¨ï¼ˆå¯é€‰ï¼‰
cd frontend
node proxy-server.js

# æŸ¥çœ‹ä»£ç†æ—¥å¿—
tail -f ../frontend-proxy.log
```

## âš ï¸ å¸¸è§é—®é¢˜

### 1. Redisè¿æ¥é—®é¢˜

å¦‚æœé‡åˆ°Redisè¿æ¥é—®é¢˜ï¼Œå¥åº·æ£€æŸ¥å¯èƒ½æ˜¾ç¤ºDOWNçŠ¶æ€ï¼Œä½†ä¸å½±å“ä¸»è¦APIåŠŸèƒ½ã€‚

### 2. ç«¯å£å†²çª

ç¡®ä¿8081ç«¯å£æ²¡æœ‰è¢«å…¶ä»–æœåŠ¡å ç”¨ï¼š

```bash
lsof -i :8081
```

### 3. DockeræœåŠ¡å¯åŠ¨å¤±è´¥

æ£€æŸ¥Dockeræ˜¯å¦æ­£å¸¸è¿è¡Œï¼š

```bash
docker info
```

## ğŸ“ å¼€å‘æµç¨‹

### 1. å‰ç«¯å¼€å‘

1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€ `frontend` ç›®å½•
2. ä¿®æ”¹é¡µé¢å’Œç»„ä»¶ä»£ç 
3. ä½¿ç”¨ `http://localhost:8081/api` ä½œä¸ºAPIåŸºç¡€URL
4. å®æ—¶é¢„è§ˆå’Œè°ƒè¯•

### 2. åç«¯å¼€å‘

1. ä¿®æ”¹åç«¯ä»£ç 
2. é‡æ–°æ„å»ºDockeré•œåƒï¼š`docker-compose build backend`
3. é‡å¯æœåŠ¡ï¼š`docker-compose up -d backend`
4. æµ‹è¯•APIæ¥å£

### 3. è”è°ƒæµ‹è¯•

1. ç¡®ä¿åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ
2. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æµ‹è¯•APIè°ƒç”¨
3. ä½¿ç”¨ `./test-wechat-api.sh` éªŒè¯æ¥å£

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **å®Œå–„APIæ¥å£**: å®ç°æ›´å¤šä¸šåŠ¡åŠŸèƒ½
2. **å‰ç«¯é¡µé¢å¼€å‘**: å®Œå–„å¾®ä¿¡å°ç¨‹åºç•Œé¢
3. **æ•°æ®åº“ä¼˜åŒ–**: æ ¹æ®éœ€è¦è°ƒæ•´æ•°æ®åº“ç»“æ„
4. **æ€§èƒ½ä¼˜åŒ–**: ä¼˜åŒ–APIå“åº”é€Ÿåº¦
5. **éƒ¨ç½²å‡†å¤‡**: å‡†å¤‡ç”Ÿäº§ç¯å¢ƒé…ç½®

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š

1. DockeræœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
2. ç«¯å£æ˜¯å¦è¢«å ç”¨
3. é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
4. æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

---

**å¼€å‘ç¯å¢ƒå·²é…ç½®å®Œæˆï¼Œå¯ä»¥å¼€å§‹å¾®ä¿¡å°ç¨‹åºå¼€å‘ï¼** ğŸ‰ 